{"ast":null,"code":"import { b as auditsStoreName } from '../constants-4d9682b2.js';\nexport { b as auditsStoreName } from '../constants-4d9682b2.js';\nimport { createAction, createSlice } from '@reduxjs/toolkit';\nimport { takeEvery, select as select$1, put, call, all } from 'redux-saga/effects';\nimport { api } from '@frontegg/rest-api';\n\nconst typeReducerForKey = key => ({\n  prepare: payload => ({\n    payload\n  }),\n  reducer: (state, {\n    payload\n  }) => {\n    return Object.assign(Object.assign({}, state), {\n      [key]: Object.assign(Object.assign({}, state[key]), payload)\n    });\n  }\n});\n\nconst auditLogsState = {\n  loading: true,\n  pageOffset: 0,\n  pageSize: 20,\n  logs: [],\n  sort: [],\n  filter: [],\n  totalPages: 0,\n  isDownloadingCsv: false\n};\nconst reducers$1 = {\n  setAuditLogsState: typeReducerForKey('auditLogsState'),\n  resetAuditLogsState: state => Object.assign(Object.assign({}, state), {\n    auditLogsState\n  })\n};\nconst actions$2 = {\n  exportAuditsCsv: createAction(`${auditsStoreName}/exportAuditsCsv`),\n  loadAuditLogs: createAction(`${auditsStoreName}/loadAuditLogs`, payload => ({\n    payload\n  }))\n};\nconst auditsMetadataState = {\n  loading: true\n};\nconst reducers = {\n  setAuditsMetadataState: typeReducerForKey('auditsMetadataState'),\n  resetAuditsMetadataState: state => Object.assign(Object.assign({}, state), {\n    auditsMetadataState\n  })\n};\nconst actions$1 = {\n  loadAuditsMetadata: createAction(`${auditsStoreName}/loadAuditsMetadata`)\n};\nconst initialState = {\n  auditLogsState,\n  auditsMetadataState\n};\nconst {\n  reducer,\n  actions: sliceActions\n} = createSlice({\n  name: auditsStoreName,\n  initialState,\n  reducers: Object.assign(Object.assign({\n    resetState: state => Object.assign(Object.assign({}, state), initialState),\n    setState: (state, {\n      payload\n    }) => Object.assign(Object.assign({}, state), payload)\n  }, reducers$1), reducers)\n});\nconst actions = Object.assign(Object.assign(Object.assign({}, sliceActions), actions$2), actions$1);\n\nconst sortMethodBasedOnOrder = (sortBy, desc) => (a, b) => {\n  if (a[sortBy] > b[sortBy]) {\n    return desc ? -1 : 1;\n  }\n\n  if (b[sortBy] > a[sortBy]) {\n    return desc ? 1 : -1;\n  }\n\n  return 0;\n};\n\nconst filterAuditsByQuery = filterOptions => log => filterOptions.filter(filterOutTimeFilterForDummyMode).every(filterItem => log[filterItem.id].includes(filterItem.value));\n\nconst filterOutTimeFilterForDummyMode = filterItem => filterItem.id !== 'createdAt';\n\nconst auditsLogsFilterAndSort = (filterOptions, sortOptions) => {\n  const {\n    data\n  } = auditLogsDataDemo;\n  let dataByQuery = data.filter(filterAuditsByQuery(filterOptions));\n\n  if (sortOptions.length) {\n    const {\n      id,\n      desc = false\n    } = sortOptions[0];\n    dataByQuery = dataByQuery.sort(sortMethodBasedOnOrder(id, desc));\n  }\n\n  return {\n    data: dataByQuery,\n    total: dataByQuery.length\n  };\n};\n\nconst randomAction = () => {\n  const random = Math.floor(Math.random() * 6);\n\n  switch (random) {\n    case 0:\n      return {\n        action: 'Updated profile',\n        description: 'User updated profile details',\n        severity: 'Info'\n      };\n\n    case 1:\n      return {\n        action: 'User logged in',\n        severity: 'Info',\n        description: 'User logged in to the product'\n      };\n\n    case 2:\n      return {\n        action: 'User failed to login',\n        severity: 'High',\n        description: 'User failed to login with password'\n      };\n\n    case 3:\n      return {\n        action: 'Added user',\n        severity: 'Info',\n        description: 'Added user david+535@frontegg.com to tenant'\n      };\n\n    case 4:\n      return {\n        action: 'Assigned roles',\n        severity: 'Info',\n        description: 'Assigned 0 roles for user'\n      };\n\n    case 5:\n      return {\n        action: 'Removed user david+108@frontegg.com from account',\n        severity: 'Info',\n        description: 'Removed access from the account for user david+108@frontegg.com'\n      };\n  }\n};\n\nconst auditLogsDataDemo = {\n  total: 20,\n  data: Array.from(Array(5).keys()).map(i => Object.assign(Object.assign({\n    ip: '198.143.51.1',\n    user: 'Demo User Name',\n    email: 'demo-user@frontegg.com'\n  }, randomAction()), {\n    json: {\n      key1: 'value1',\n      key2: 'value2',\n      key3: 'value3',\n      key4: 'value4'\n    },\n    tenantId: 'my-tenant-id',\n    vendorId: 'my-vendor-id',\n    userAgent: 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.114 Safari/537.36',\n    createdAt: `2022-04-07 10:${50 - i}:40.201`\n  }))\n};\nconst auditLogsMetadataDemo = {\n  properties: [{\n    showInTable: true,\n    name: 'createdAt',\n    displayName: 'Time',\n    type: 'Timestamp',\n    sortable: true,\n    filterable: true,\n    showInMoreInfo: 'Always',\n    chosen: false,\n    selected: false,\n    isPredefined: false\n  }, {\n    showInTable: true,\n    name: 'email',\n    displayName: 'User',\n    type: 'Email',\n    filterable: true,\n    sortable: true,\n    isPredefined: true,\n    chosen: false,\n    selected: false\n  }, {\n    showInTable: true,\n    name: 'action',\n    displayName: 'Action',\n    type: 'AlphaNumeric',\n    sortable: true,\n    filterable: true,\n    showInMoreInfo: 'Always',\n    chosen: false,\n    selected: false,\n    isPredefined: true\n  }, {\n    showInTable: true,\n    name: 'description',\n    type: 'AlphaNumeric',\n    sortable: false,\n    filterable: false,\n    displayName: 'Description',\n    isPredefined: true,\n    chosen: false,\n    selected: false\n  }, {\n    showInTable: true,\n    name: 'ip',\n    displayName: 'IP Address',\n    type: 'IpAddress',\n    sortable: true,\n    filterable: true,\n    showInMoreInfo: 'Always',\n    chosen: false,\n    selected: false,\n    isPredefined: true\n  }, {\n    showInTable: false,\n    name: 'severity',\n    displayName: 'Severity',\n    type: 'Severity',\n    sortable: true,\n    filterable: true,\n    showInMoreInfo: 'Always',\n    chosen: false,\n    selected: false,\n    isPredefined: true\n  }, {\n    showInTable: false,\n    name: 'userAgent',\n    displayName: 'User Agent',\n    type: 'AlphaNumeric',\n    filterable: true,\n    sortable: true,\n    isPredefined: true,\n    chosen: false,\n    selected: false\n  }, {\n    showInTable: false,\n    name: 'json',\n    type: 'Json',\n    sortable: true,\n    filterable: true,\n    displayName: 'Json Data',\n    showInMoreInfo: 'Always',\n    isPredefined: false\n  }]\n};\n\nconst select = () => select$1(_ => _[auditsStoreName].auditLogsState);\n\nconst selectMetadata = () => select$1(_ => _[auditsStoreName].auditsMetadataState);\n\nfunction* exportAuditsCsv() {\n  const state = yield select();\n  const {\n    columns\n  } = yield selectMetadata();\n\n  try {\n    const filter = state.filter;\n    const sort = state.sort;\n    const sortParams = sort.reduce((p, n) => Object.assign(Object.assign({}, p), {\n      sortBy: n.id,\n      sortDirection: n.desc ? 'desc' : 'asc'\n    }), {});\n    const filterParams = filter.reduce((p, n) => Object.assign(Object.assign({}, p), {\n      [n.id]: encodeURIComponent(n.value)\n    }), {});\n    yield put(actions.setAuditLogsState({\n      isDownloadingCsv: true\n    }));\n    const outputFileName = `audits.csv`;\n    yield api.audits.exportAudits(Object.assign(Object.assign({\n      endpoint: 'csv/v2',\n      headerProps: columns,\n      offset: 0,\n      outputFileName\n    }, sortParams), filterParams));\n  } catch (e) {\n    console.error('failed to export audits - ', e);\n  }\n\n  yield put(actions.setAuditLogsState({\n    isDownloadingCsv: false\n  }));\n}\n\nfunction* loadAuditLogs({\n  payload\n}) {\n  var _a, _b, _c, _d, _e, _f;\n\n  yield put(actions.setAuditLogsState({\n    loading: !(payload === null || payload === void 0 ? void 0 : payload.silentLoading),\n    error: null\n  }));\n  const state = yield select();\n  const {\n    columns\n  } = yield selectMetadata();\n\n  try {\n    const pageSize = (_a = payload.pageSize) !== null && _a !== void 0 ? _a : state.pageSize;\n    const pageOffset = (_b = payload.pageOffset) !== null && _b !== void 0 ? _b : state.pageOffset;\n    const filter = (_c = payload.filter) !== null && _c !== void 0 ? _c : state.filter;\n    const sort = (_d = payload.sort) !== null && _d !== void 0 ? _d : state.sort;\n    yield put(actions.setAuditLogsState({\n      pageSize,\n      pageOffset,\n      filter,\n      sort\n    }));\n    const sortParams = sort.reduce((p, n) => Object.assign(Object.assign({}, p), {\n      sortBy: n.id,\n      sortDirection: n.desc ? 'desc' : 'asc'\n    }), {});\n    const filterParams = filter.reduce((p, n) => Object.assign(Object.assign({}, p), {\n      [n.id]: n.value\n    }), {});\n\n    if (!columns) {\n      yield put(actions.loadAuditsMetadata());\n    }\n\n    const {\n      data,\n      total\n    } = yield call(api.audits.getAudits, Object.assign(Object.assign({\n      offset: pageOffset,\n      count: pageSize\n    }, sortParams), filterParams));\n    yield put(actions.setAuditLogsState({\n      loading: false,\n      logs: data !== null && data !== void 0 ? data : [],\n      totalPages: +Math.ceil(total / pageSize)\n    }));\n    (_e = payload === null || payload === void 0 ? void 0 : payload.callback) === null || _e === void 0 ? void 0 : _e.call(payload, true);\n  } catch (e) {\n    yield put(actions.setAuditLogsState({\n      loading: false,\n      error: e.message\n    }));\n    (_f = payload === null || payload === void 0 ? void 0 : payload.callback) === null || _f === void 0 ? void 0 : _f.call(payload, null, e);\n  }\n}\n\nfunction* auditLogsSagas() {\n  yield takeEvery(actions.exportAuditsCsv, exportAuditsCsv);\n  yield takeEvery(actions.loadAuditLogs, loadAuditLogs);\n}\n/*********************************\r\n *  Preview Sagas\r\n *********************************/\n\n\nfunction* loadAuditLogsMock({\n  payload\n}) {\n  var _a, _b, _c, _d, _e, _f;\n\n  yield put(actions.setAuditLogsState({\n    loading: !(payload === null || payload === void 0 ? void 0 : payload.silentLoading),\n    error: null\n  }));\n  const state = yield select();\n  const {\n    columns\n  } = yield selectMetadata();\n\n  try {\n    const pageSize = (_a = payload.pageSize) !== null && _a !== void 0 ? _a : state.pageSize;\n    const pageOffset = (_b = payload.pageOffset) !== null && _b !== void 0 ? _b : state.pageOffset;\n    const filter = (_c = payload.filter) !== null && _c !== void 0 ? _c : state.filter;\n    const sort = (_d = payload.sort) !== null && _d !== void 0 ? _d : state.sort;\n    yield put(actions.setAuditLogsState({\n      pageSize,\n      pageOffset,\n      filter,\n      sort\n    }));\n\n    if (!columns) {\n      yield put(actions.loadAuditsMetadata());\n    }\n\n    const {\n      data,\n      total\n    } = auditsLogsFilterAndSort(filter, sort);\n    yield put(actions.setAuditLogsState({\n      loading: false,\n      logs: data !== null && data !== void 0 ? data : [],\n      totalPages: +Math.ceil(total / pageSize)\n    }));\n    (_e = payload === null || payload === void 0 ? void 0 : payload.callback) === null || _e === void 0 ? void 0 : _e.call(payload, true);\n  } catch (e) {\n    yield put(actions.setAuditLogsState({\n      loading: false,\n      error: e.message\n    }));\n    (_f = payload === null || payload === void 0 ? void 0 : payload.callback) === null || _f === void 0 ? void 0 : _f.call(payload, null, e);\n  }\n}\n\nfunction* auditLogsSagasMock() {\n  yield takeEvery(actions.loadAuditLogs, loadAuditLogsMock);\n}\n\nfunction* loadAuditsMetadata() {\n  yield put(actions.setAuditsMetadataState({\n    loading: true,\n    error: null\n  }));\n\n  try {\n    const {\n      properties\n    } = yield call(api.metadata.getAuditsMetadata);\n    yield put(actions.setAuditsMetadataState({\n      columns: properties,\n      loading: false\n    }));\n  } catch (e) {\n    yield put(actions.setAuditsMetadataState({\n      error: e,\n      loading: false\n    }));\n  }\n}\n\nfunction* auditsMetadataSagas() {\n  yield takeEvery(actions.loadAuditsMetadata, loadAuditsMetadata);\n}\n/*********************************\r\n *  Preview Sagas\r\n *********************************/\n\n\nfunction* loadAuditsMetadataMock() {\n  yield put(actions.setAuditsMetadataState({\n    loading: true,\n    error: null\n  }));\n\n  try {\n    const {\n      properties\n    } = auditLogsMetadataDemo;\n    yield put(actions.setAuditsMetadataState({\n      columns: properties,\n      loading: false\n    }));\n  } catch (e) {\n    yield put(actions.setAuditsMetadataState({\n      error: e,\n      loading: false\n    }));\n  }\n}\n\nfunction* auditsMetadataSagasMock() {\n  yield takeEvery(actions.loadAuditsMetadata, loadAuditsMetadataMock);\n}\n\nfunction* sagas() {\n  yield all([call(auditLogsSagas), call(auditsMetadataSagas)]);\n}\n\nfunction* mockSagas() {\n  yield all([call(auditLogsSagasMock), call(auditsMetadataSagasMock)]);\n} // export store\n\n\nvar auditsStore = {\n  sagas,\n  mockSagas,\n  storeName: auditsStoreName,\n  initialState,\n  reducer,\n  actions\n};\nexport { actions$2 as auditLogsActions, reducers$1 as auditLogsReducers, auditLogsState, actions as auditsActions, initialState as auditsInitialState, actions$1 as auditsMetadataActions, reducers as auditsMetadataReducers, auditsMetadataState, mockSagas as auditsMockSagas, reducer as auditsReducers, sagas as auditsSagas, auditsStore as default };","map":{"version":3,"sources":["/Users/mashapav/Downloads/WEB-CHAT/Client/node_modules/@frontegg/redux-store/audits/index.js"],"names":["b","auditsStoreName","createAction","createSlice","takeEvery","select","select$1","put","call","all","api","typeReducerForKey","key","prepare","payload","reducer","state","Object","assign","auditLogsState","loading","pageOffset","pageSize","logs","sort","filter","totalPages","isDownloadingCsv","reducers$1","setAuditLogsState","resetAuditLogsState","actions$2","exportAuditsCsv","loadAuditLogs","auditsMetadataState","reducers","setAuditsMetadataState","resetAuditsMetadataState","actions$1","loadAuditsMetadata","initialState","actions","sliceActions","name","resetState","setState","sortMethodBasedOnOrder","sortBy","desc","a","filterAuditsByQuery","filterOptions","log","filterOutTimeFilterForDummyMode","every","filterItem","id","includes","value","auditsLogsFilterAndSort","sortOptions","data","auditLogsDataDemo","dataByQuery","length","total","randomAction","random","Math","floor","action","description","severity","Array","from","keys","map","i","ip","user","email","json","key1","key2","key3","key4","tenantId","vendorId","userAgent","createdAt","auditLogsMetadataDemo","properties","showInTable","displayName","type","sortable","filterable","showInMoreInfo","chosen","selected","isPredefined","_","selectMetadata","columns","sortParams","reduce","p","n","sortDirection","filterParams","encodeURIComponent","outputFileName","audits","exportAudits","endpoint","headerProps","offset","e","console","error","_a","_b","_c","_d","_e","_f","silentLoading","getAudits","count","ceil","callback","message","auditLogsSagas","loadAuditLogsMock","auditLogsSagasMock","metadata","getAuditsMetadata","auditsMetadataSagas","loadAuditsMetadataMock","auditsMetadataSagasMock","sagas","mockSagas","auditsStore","storeName","auditLogsActions","auditLogsReducers","auditsActions","auditsInitialState","auditsMetadataActions","auditsMetadataReducers","auditsMockSagas","auditsReducers","auditsSagas","default"],"mappings":"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","sourcesContent":["import { b as auditsStoreName } from '../constants-4d9682b2.js';\nexport { b as auditsStoreName } from '../constants-4d9682b2.js';\nimport { createAction, createSlice } from '@reduxjs/toolkit';\nimport { takeEvery, select as select$1, put, call, all } from 'redux-saga/effects';\nimport { api } from '@frontegg/rest-api';\n\nconst typeReducerForKey = (key) => ({\r\n    prepare: (payload) => ({ payload }),\r\n    reducer: (state, { payload }) => {\r\n        return Object.assign(Object.assign({}, state), { [key]: Object.assign(Object.assign({}, state[key]), payload) });\r\n    },\r\n});\n\nconst auditLogsState = {\r\n    loading: true,\r\n    pageOffset: 0,\r\n    pageSize: 20,\r\n    logs: [],\r\n    sort: [],\r\n    filter: [],\r\n    totalPages: 0,\r\n    isDownloadingCsv: false,\r\n};\r\nconst reducers$1 = {\r\n    setAuditLogsState: typeReducerForKey('auditLogsState'),\r\n    resetAuditLogsState: (state) => (Object.assign(Object.assign({}, state), { auditLogsState })),\r\n};\r\nconst actions$2 = {\r\n    exportAuditsCsv: createAction(`${auditsStoreName}/exportAuditsCsv`),\r\n    loadAuditLogs: createAction(`${auditsStoreName}/loadAuditLogs`, (payload) => ({ payload })),\r\n};\n\nconst auditsMetadataState = {\r\n    loading: true,\r\n};\r\nconst reducers = {\r\n    setAuditsMetadataState: typeReducerForKey('auditsMetadataState'),\r\n    resetAuditsMetadataState: (state) => (Object.assign(Object.assign({}, state), { auditsMetadataState })),\r\n};\r\nconst actions$1 = {\r\n    loadAuditsMetadata: createAction(`${auditsStoreName}/loadAuditsMetadata`),\r\n};\n\nconst initialState = {\r\n    auditLogsState,\r\n    auditsMetadataState,\r\n};\n\nconst { reducer, actions: sliceActions } = createSlice({\r\n    name: auditsStoreName,\r\n    initialState,\r\n    reducers: Object.assign(Object.assign({ resetState: (state) => (Object.assign(Object.assign({}, state), initialState)), setState: (state, { payload }) => (Object.assign(Object.assign({}, state), payload)) }, reducers$1), reducers),\r\n});\r\nconst actions = Object.assign(Object.assign(Object.assign({}, sliceActions), actions$2), actions$1);\n\nconst sortMethodBasedOnOrder = (sortBy, desc) => (a, b) => {\r\n    if (a[sortBy] > b[sortBy]) {\r\n        return desc ? -1 : 1;\r\n    }\r\n    if (b[sortBy] > a[sortBy]) {\r\n        return desc ? 1 : -1;\r\n    }\r\n    return 0;\r\n};\r\nconst filterAuditsByQuery = (filterOptions) => (log) => filterOptions\r\n    .filter(filterOutTimeFilterForDummyMode)\r\n    .every((filterItem) => log[filterItem.id].includes(filterItem.value));\r\nconst filterOutTimeFilterForDummyMode = (filterItem) => filterItem.id !== 'createdAt';\r\nconst auditsLogsFilterAndSort = (filterOptions, sortOptions) => {\r\n    const { data } = auditLogsDataDemo;\r\n    let dataByQuery = data.filter(filterAuditsByQuery(filterOptions));\r\n    if (sortOptions.length) {\r\n        const { id, desc = false } = sortOptions[0];\r\n        dataByQuery = dataByQuery.sort(sortMethodBasedOnOrder(id, desc));\r\n    }\r\n    return { data: dataByQuery, total: dataByQuery.length };\r\n};\r\nconst randomAction = () => {\r\n    const random = Math.floor(Math.random() * 6);\r\n    switch (random) {\r\n        case 0:\r\n            return {\r\n                action: 'Updated profile',\r\n                description: 'User updated profile details',\r\n                severity: 'Info',\r\n            };\r\n        case 1:\r\n            return {\r\n                action: 'User logged in',\r\n                severity: 'Info',\r\n                description: 'User logged in to the product',\r\n            };\r\n        case 2:\r\n            return {\r\n                action: 'User failed to login',\r\n                severity: 'High',\r\n                description: 'User failed to login with password',\r\n            };\r\n        case 3:\r\n            return {\r\n                action: 'Added user',\r\n                severity: 'Info',\r\n                description: 'Added user david+535@frontegg.com to tenant',\r\n            };\r\n        case 4:\r\n            return {\r\n                action: 'Assigned roles',\r\n                severity: 'Info',\r\n                description: 'Assigned 0 roles for user',\r\n            };\r\n        case 5:\r\n            return {\r\n                action: 'Removed user david+108@frontegg.com from account',\r\n                severity: 'Info',\r\n                description: 'Removed access from the account for user david+108@frontegg.com',\r\n            };\r\n    }\r\n};\r\nconst auditLogsDataDemo = {\r\n    total: 20,\r\n    data: Array.from(Array(5).keys()).map((i) => (Object.assign(Object.assign({ ip: '198.143.51.1', user: 'Demo User Name', email: 'demo-user@frontegg.com' }, randomAction()), { json: { key1: 'value1', key2: 'value2', key3: 'value3', key4: 'value4' }, tenantId: 'my-tenant-id', vendorId: 'my-vendor-id', userAgent: 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.114 Safari/537.36', createdAt: `2022-04-07 10:${50 - i}:40.201` }))),\r\n};\r\nconst auditLogsMetadataDemo = {\r\n    properties: [\r\n        {\r\n            showInTable: true,\r\n            name: 'createdAt',\r\n            displayName: 'Time',\r\n            type: 'Timestamp',\r\n            sortable: true,\r\n            filterable: true,\r\n            showInMoreInfo: 'Always',\r\n            chosen: false,\r\n            selected: false,\r\n            isPredefined: false,\r\n        },\r\n        {\r\n            showInTable: true,\r\n            name: 'email',\r\n            displayName: 'User',\r\n            type: 'Email',\r\n            filterable: true,\r\n            sortable: true,\r\n            isPredefined: true,\r\n            chosen: false,\r\n            selected: false,\r\n        },\r\n        {\r\n            showInTable: true,\r\n            name: 'action',\r\n            displayName: 'Action',\r\n            type: 'AlphaNumeric',\r\n            sortable: true,\r\n            filterable: true,\r\n            showInMoreInfo: 'Always',\r\n            chosen: false,\r\n            selected: false,\r\n            isPredefined: true,\r\n        },\r\n        {\r\n            showInTable: true,\r\n            name: 'description',\r\n            type: 'AlphaNumeric',\r\n            sortable: false,\r\n            filterable: false,\r\n            displayName: 'Description',\r\n            isPredefined: true,\r\n            chosen: false,\r\n            selected: false,\r\n        },\r\n        {\r\n            showInTable: true,\r\n            name: 'ip',\r\n            displayName: 'IP Address',\r\n            type: 'IpAddress',\r\n            sortable: true,\r\n            filterable: true,\r\n            showInMoreInfo: 'Always',\r\n            chosen: false,\r\n            selected: false,\r\n            isPredefined: true,\r\n        },\r\n        {\r\n            showInTable: false,\r\n            name: 'severity',\r\n            displayName: 'Severity',\r\n            type: 'Severity',\r\n            sortable: true,\r\n            filterable: true,\r\n            showInMoreInfo: 'Always',\r\n            chosen: false,\r\n            selected: false,\r\n            isPredefined: true,\r\n        },\r\n        {\r\n            showInTable: false,\r\n            name: 'userAgent',\r\n            displayName: 'User Agent',\r\n            type: 'AlphaNumeric',\r\n            filterable: true,\r\n            sortable: true,\r\n            isPredefined: true,\r\n            chosen: false,\r\n            selected: false,\r\n        },\r\n        {\r\n            showInTable: false,\r\n            name: 'json',\r\n            type: 'Json',\r\n            sortable: true,\r\n            filterable: true,\r\n            displayName: 'Json Data',\r\n            showInMoreInfo: 'Always',\r\n            isPredefined: false,\r\n        },\r\n    ],\r\n};\n\nconst select = () => select$1((_) => _[auditsStoreName].auditLogsState);\r\nconst selectMetadata = () => select$1((_) => _[auditsStoreName].auditsMetadataState);\r\nfunction* exportAuditsCsv() {\r\n    const state = yield select();\r\n    const { columns } = yield selectMetadata();\r\n    try {\r\n        const filter = state.filter;\r\n        const sort = state.sort;\r\n        const sortParams = sort.reduce((p, n) => (Object.assign(Object.assign({}, p), { sortBy: n.id, sortDirection: n.desc ? 'desc' : 'asc' })), {});\r\n        const filterParams = filter.reduce((p, n) => (Object.assign(Object.assign({}, p), { [n.id]: encodeURIComponent(n.value) })), {});\r\n        yield put(actions.setAuditLogsState({ isDownloadingCsv: true }));\r\n        const outputFileName = `audits.csv`;\r\n        yield api.audits.exportAudits(Object.assign(Object.assign({ endpoint: 'csv/v2', headerProps: columns, offset: 0, outputFileName }, sortParams), filterParams));\r\n    }\r\n    catch (e) {\r\n        console.error('failed to export audits - ', e);\r\n    }\r\n    yield put(actions.setAuditLogsState({ isDownloadingCsv: false }));\r\n}\r\nfunction* loadAuditLogs({ payload }) {\r\n    var _a, _b, _c, _d, _e, _f;\r\n    yield put(actions.setAuditLogsState({ loading: !(payload === null || payload === void 0 ? void 0 : payload.silentLoading), error: null }));\r\n    const state = yield select();\r\n    const { columns } = yield selectMetadata();\r\n    try {\r\n        const pageSize = (_a = payload.pageSize) !== null && _a !== void 0 ? _a : state.pageSize;\r\n        const pageOffset = (_b = payload.pageOffset) !== null && _b !== void 0 ? _b : state.pageOffset;\r\n        const filter = (_c = payload.filter) !== null && _c !== void 0 ? _c : state.filter;\r\n        const sort = (_d = payload.sort) !== null && _d !== void 0 ? _d : state.sort;\r\n        yield put(actions.setAuditLogsState({\r\n            pageSize,\r\n            pageOffset,\r\n            filter,\r\n            sort,\r\n        }));\r\n        const sortParams = sort.reduce((p, n) => (Object.assign(Object.assign({}, p), { sortBy: n.id, sortDirection: n.desc ? 'desc' : 'asc' })), {});\r\n        const filterParams = filter.reduce((p, n) => (Object.assign(Object.assign({}, p), { [n.id]: n.value })), {});\r\n        if (!columns) {\r\n            yield put(actions.loadAuditsMetadata());\r\n        }\r\n        const { data, total } = yield call(api.audits.getAudits, Object.assign(Object.assign({ offset: pageOffset, count: pageSize }, sortParams), filterParams));\r\n        yield put(actions.setAuditLogsState({\r\n            loading: false,\r\n            logs: data !== null && data !== void 0 ? data : [],\r\n            totalPages: +Math.ceil(total / pageSize),\r\n        }));\r\n        (_e = payload === null || payload === void 0 ? void 0 : payload.callback) === null || _e === void 0 ? void 0 : _e.call(payload, true);\r\n    }\r\n    catch (e) {\r\n        yield put(actions.setAuditLogsState({ loading: false, error: e.message }));\r\n        (_f = payload === null || payload === void 0 ? void 0 : payload.callback) === null || _f === void 0 ? void 0 : _f.call(payload, null, e);\r\n    }\r\n}\r\nfunction* auditLogsSagas() {\r\n    yield takeEvery(actions.exportAuditsCsv, exportAuditsCsv);\r\n    yield takeEvery(actions.loadAuditLogs, loadAuditLogs);\r\n}\r\n/*********************************\r\n *  Preview Sagas\r\n *********************************/\r\nfunction* loadAuditLogsMock({ payload }) {\r\n    var _a, _b, _c, _d, _e, _f;\r\n    yield put(actions.setAuditLogsState({ loading: !(payload === null || payload === void 0 ? void 0 : payload.silentLoading), error: null }));\r\n    const state = yield select();\r\n    const { columns } = yield selectMetadata();\r\n    try {\r\n        const pageSize = (_a = payload.pageSize) !== null && _a !== void 0 ? _a : state.pageSize;\r\n        const pageOffset = (_b = payload.pageOffset) !== null && _b !== void 0 ? _b : state.pageOffset;\r\n        const filter = (_c = payload.filter) !== null && _c !== void 0 ? _c : state.filter;\r\n        const sort = (_d = payload.sort) !== null && _d !== void 0 ? _d : state.sort;\r\n        yield put(actions.setAuditLogsState({\r\n            pageSize,\r\n            pageOffset,\r\n            filter,\r\n            sort,\r\n        }));\r\n        if (!columns) {\r\n            yield put(actions.loadAuditsMetadata());\r\n        }\r\n        const { data, total } = auditsLogsFilterAndSort(filter, sort);\r\n        yield put(actions.setAuditLogsState({\r\n            loading: false,\r\n            logs: data !== null && data !== void 0 ? data : [],\r\n            totalPages: +Math.ceil(total / pageSize),\r\n        }));\r\n        (_e = payload === null || payload === void 0 ? void 0 : payload.callback) === null || _e === void 0 ? void 0 : _e.call(payload, true);\r\n    }\r\n    catch (e) {\r\n        yield put(actions.setAuditLogsState({ loading: false, error: e.message }));\r\n        (_f = payload === null || payload === void 0 ? void 0 : payload.callback) === null || _f === void 0 ? void 0 : _f.call(payload, null, e);\r\n    }\r\n}\r\nfunction* auditLogsSagasMock() {\r\n    yield takeEvery(actions.loadAuditLogs, loadAuditLogsMock);\r\n}\n\nfunction* loadAuditsMetadata() {\r\n    yield put(actions.setAuditsMetadataState({ loading: true, error: null }));\r\n    try {\r\n        const { properties } = yield call(api.metadata.getAuditsMetadata);\r\n        yield put(actions.setAuditsMetadataState({ columns: properties, loading: false }));\r\n    }\r\n    catch (e) {\r\n        yield put(actions.setAuditsMetadataState({ error: e, loading: false }));\r\n    }\r\n}\r\nfunction* auditsMetadataSagas() {\r\n    yield takeEvery(actions.loadAuditsMetadata, loadAuditsMetadata);\r\n}\r\n/*********************************\r\n *  Preview Sagas\r\n *********************************/\r\nfunction* loadAuditsMetadataMock() {\r\n    yield put(actions.setAuditsMetadataState({ loading: true, error: null }));\r\n    try {\r\n        const { properties } = auditLogsMetadataDemo;\r\n        yield put(actions.setAuditsMetadataState({ columns: properties, loading: false }));\r\n    }\r\n    catch (e) {\r\n        yield put(actions.setAuditsMetadataState({ error: e, loading: false }));\r\n    }\r\n}\r\nfunction* auditsMetadataSagasMock() {\r\n    yield takeEvery(actions.loadAuditsMetadata, loadAuditsMetadataMock);\r\n}\n\nfunction* sagas() {\r\n    yield all([call(auditLogsSagas), call(auditsMetadataSagas)]);\r\n}\r\nfunction* mockSagas() {\r\n    yield all([call(auditLogsSagasMock), call(auditsMetadataSagasMock)]);\r\n}\n\n// export store\r\nvar auditsStore = {\r\n    sagas,\r\n    mockSagas,\r\n    storeName: auditsStoreName,\r\n    initialState,\r\n    reducer,\r\n    actions,\r\n};\n\nexport { actions$2 as auditLogsActions, reducers$1 as auditLogsReducers, auditLogsState, actions as auditsActions, initialState as auditsInitialState, actions$1 as auditsMetadataActions, reducers as auditsMetadataReducers, auditsMetadataState, mockSagas as auditsMockSagas, reducer as auditsReducers, sagas as auditsSagas, auditsStore as default };\n"]},"metadata":{},"sourceType":"module"}